language: ruby
git:
  depth: 3
  quiet: true

env:
  global:
    - DB=pgsql
    - FB_APP_ID=fb_app_id_mock
    - FB_APP_SECRET=fb_app_secret_mock
    - PGPORT=5433

addons:
  postgresql: "10"
  apt:
    packages:
      - postgresql-10
      - postgresql-client-10

cache:
  - bundler

before_install:
  - sudo apt-get update
  - sudo apt-get install -y build-essential nodejs
  - gem update --system
  - gem install bundler
  - sudo cp /etc/postgresql/{9.6,10}/main/pg_hba.conf
  - sudo /etc/init.d/postgresql restart

before_script:
  - psql -c 'create database payloca_test;' -U postgres
install: true
script: true
