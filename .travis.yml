language: bash
sudo: false

env:
  - PRIOR_VERSION="1.00"
  - RELEASE_VERSION="1.00"

before_install:
  - echo 'before_install'

install:
  - echo 'install'

jobs:
  include:
    - stage: test
      script:
        - echo 'Terraform Format Check'
    - stage: test
      script:
        - echo 'JSON Format Check'
    - stage: test
      script:
        - echo 'JSON Diff'
    - stage: deploy
      if: env(PRIOR_VERSION) != env(RELEASE_VERSION)
      script: skip
      before_deploy:
        - echo PRIOR_VERSION=$PRIOR_VERSION
        - echo RELEASE_VERSION=$RELEASE_VERSION
      deploy:
        provider: script
        script: echo "Deploy!"
