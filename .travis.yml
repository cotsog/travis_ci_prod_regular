language: ruby
dist: trusty
sudo: required

before_cache:
  - sudo chown -R $USER ./apt-cache
cache:
  directories:
    - apt-cache

addons:
  postgresql: "9.4"
  apt:
    sources:
      - sourceline: deb http://packages.couchbase.com/ubuntu trusty trusty/main
        key_url: http://packages.couchbase.com/ubuntu/couchbase.key

install: true
script:
  - pwd
  - sudo apt-get -y update
  - sudo apt-get install --no-download -o=dir::cache=${TRAVIS_BUILD_DIR}/apt-cache libcouchbase-dev libcouchbase2-libevent postgresql-9.4-postgis-2.3
